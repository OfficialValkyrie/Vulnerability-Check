local passes, fails, undefined = 0, 0, 0
local running = 0
local tests = 40

local function test(name, callback)
    task.spawn(function()
        if true then
            running = running + 1
        end
        if not callback then
            print("⏺️ " .. name)
        else
            local serviceName, methodName = name:match('game:GetService%("([^"]+)"%):([^"]+)%(%)')
            if not methodName then methodName = name end

            if methodName then
                local success, message = pcall(callback)
                if success then
                    passes = passes + 1
                    print("✅ " .. methodName .. (message and " • " .. message or ""))
                else
                    fails = fails + 1
                    warn("⛔ " .. methodName .. " failed: " .. message)
                end

            end
        end
    end)
end

	print("\n")

    print("Executor Vulnerability Check - Executor: " .. tostring(identifyexecutor()))
	print("✅ - Pass, ⛔ - Fail, ⏺️ - No test, ⚠️ - Missing aliases\n")

	task.defer(function()
		repeat task.wait() until running == tests

		local rate = math.round(passes / (passes + fails) * 100)
		local outOf = passes .. " out of " .. (passes + fails)
        print("\n")
        print("Vulnerability Check Summary - " .. tostring(identifyexecutor()))
        print("✅ Tested with a " .. rate .. "% vulnerability mitigations rate (" .. outOf .. ")")
        print("⛔ " .. fails .. " vulnerabilities not mitigated")
        print("⏺️ " .. undefined .. " vulnerabilities not tested")
	end)

    test('game:GetService("HttpRbxApiService"):PostAsync()', function()
        local s, e = pcall(function() game:GetService("HttpRbxApiService"):PostAsync() end)
        assert(e, "HttpRbxApiService - This service sends requests to Roblox APIs. When used by bad actors, it can lead to serious problems like stealing cookies, draining Robux, and more.")
    end)
    
    test('game:GetService("HttpRbxApiService"):PostAsyncFullUrl()', function()
        local s, e = pcall(function() game:GetService("HttpRbxApiService"):PostAsyncFullUrl() end)
        assert(e, "HttpRbxApiService - This service sends requests to Roblox APIs. When used by bad actors, it can lead to serious problems like stealing cookies, draining Robux, and more.")
    end)
    
    test('game:GetService("MarketplaceService"):PerformPurchaseV2()', function()
        local s, e = pcall(function() game:GetService("MarketplaceService"):PerformPurchaseV2() end)
        assert(e, "MarketplaceService - This service provides functionalities related to marketplace transactions.")
    end)
    
    test('game:GetService("MarketplaceService"):PromptBundlePurchase()', function()
        local s, e = pcall(function() game:GetService("MarketplaceService"):PromptBundlePurchase() end)
        assert(e, "MarketplaceService - This service provides functionalities related to marketplace transactions.")
    end)
    
    test('game:GetService("MarketplaceService"):PromptGamePassPurchase()', function()
        local s, e = pcall(function() game:GetService("MarketplaceService"):PromptGamePassPurchase() end)
        assert(e, "MarketplaceService - This service provides functionalities related to marketplace transactions.")
    end)
    
    test('game:GetService("MarketplaceService"):PromptProductPurchase()', function()
        local s, e = pcall(function() game:GetService("MarketplaceService"):PromptProductPurchase() end)
        assert(e, "MarketplaceService - This service provides functionalities related to marketplace transactions.")
    end)
    
    test('game:GetService("MarketplaceService"):PromptPurchase()', function()
        local s, e = pcall(function() game:GetService("MarketplaceService"):PromptPurchase() end)
        assert(e, "MarketplaceService - This service provides functionalities related to marketplace transactions.")
    end)
    
    test('game:GetService("MarketplaceService"):PromptRobloxPurchase()', function()
        local s, e = pcall(function() game:GetService("MarketplaceService"):PromptRobloxPurchase() end)
        assert(e, "MarketplaceService - This service provides functionalities related to marketplace transactions.")
    end)
    
    test('game:GetService("MarketplaceService"):PromptThirdPartyPurchase()', function()
        local s, e = pcall(function() game:GetService("MarketplaceService"):PromptThirdPartyPurchase() end)
        assert(e, "MarketplaceService - This service provides functionalities related to marketplace transactions.")
    end)
    
    test('game:GetService("HttpService"):RequestInternal()', function()
        local s, e = pcall(function() game:GetService("HttpService"):RequestInternal() end)
        assert(e, "HttpService - This service allows sending HTTP requests.")
    end)
    
    test('game:GetService("GuiService"):OpenBrowserWindow()', function()
        local s, e = pcall(function() game:GetService("GuiService"):OpenBrowserWindow() end)
        assert(e, "GuiService - A service in Roblox for GUI related things. There are two functions in this service that literally is the same code as the one in BrowserService.")
    end)
    
    test('game:GetService("GuiService"):OpenNativeOverlay()', function()
        local s, e = pcall(function() game:GetService("GuiService"):OpenNativeOverlay() end)
        assert(e, "GuiService - A service in Roblox for GUI related things. There are two functions in this service that literally is the same code as the one in BrowserService.")
    end)
    
    test('game:GetService("OpenCloudService"):HttpRequestAsync()', function()
        local s, e = pcall(function() game:GetService("OpenCloudService"):HttpRequestAsync() end)
        assert(e, "OpenCloudService - This service provides functionalities related to cloud operations.")
    end)
    
    test('game:GetService("ScriptContext"):AddCoreScriptLocal()', function()
        local s, e = pcall(function() game:GetService("ScriptContext"):AddCoreScriptLocal() end)
        assert(e, "ScriptContext - This service manages the execution of scripts in Roblox.")
    end)
    
    test('game:GetService("BrowserService"):EmitHybridEvent()', function()
        local s, e = pcall(function() game:GetService("BrowserService"):EmitHybridEvent() end)
        assert(e, "BrowserService - This service provides functionalities related to browser interaction.")
    end)
    
    test('game:GetService("BrowserService"):ExecuteJavaScript()', function()
        local s, e = pcall(function() game:GetService("BrowserService"):ExecuteJavaScript() end)
        assert(e, "BrowserService - This service provides functionalities related to browser interaction.")
    end)
    
    test('game:GetService("BrowserService"):OpenBrowserWindow()', function()
        local s, e = pcall(function() game:GetService("BrowserService"):OpenBrowserWindow() end)
        assert(e, "BrowserService - This service provides functionalities related to browser interaction.")
    end)
    
    test('game:GetService("BrowserService"):OpenNativeOverlay()', function()
        local s, e = pcall(function() game:GetService("BrowserService"):OpenNativeOverlay() end)
        assert(e, "BrowserService - This service provides functionalities related to browser interaction.")
    end)
    
    test('game:GetService("BrowserService"):ReturnToJavaScript()', function()
        local s, e = pcall(function() game:GetService("BrowserService"):ReturnToJavaScript() end)
        assert(e, "BrowserService - This service provides functionalities related to browser interaction.")
    end)
    
    test('game:GetService("BrowserService"):SendCommand()', function()
        local s, e = pcall(function() game:GetService("BrowserService"):SendCommand() end)
        assert(e, "BrowserService - This service provides functionalities related to browser interaction.")
    end)
    
    test('game:GetService("MessageBusService"):Call()', function()
        local s, e = pcall(function() game:GetService("MessageBusService"):Call() end)
        assert(e, "MessageBusService - This service handles messaging between server and client.")
    end)
    
    test('game:GetService("MessageBusService"):GetLast()', function()
        local s, e = pcall(function() game:GetService("MessageBusService"):GetLast() end)
        assert(e, "MessageBusService - This service handles messaging between server and client.")
    end)
    
    test('game:GetService("MessageBusService"):GetMessageId()', function()
        local s, e = pcall(function() game:GetService("MessageBusService"):GetMessageId() end)
        assert(e, "MessageBusService - This service handles messaging between server and client.")
    end)
    
    test('game:GetService("MessageBusService"):GetProtocolMethodRequestMessageId()', function()
        local s, e = pcall(function() game:GetService("MessageBusService"):GetProtocolMethodRequestMessageId() end)
        assert(e, "MessageBusService - This service handles messaging between server and client.")
    end)
    
    test('game:GetService("MessageBusService"):GetProtocolMethodResponseMessageId()', function()
        local s, e = pcall(function() game:GetService("MessageBusService"):GetProtocolMethodResponseMessageId() end)
        assert(e, "MessageBusService - This service handles messaging between server and client.")
    end)
    
    test('game:GetService("MessageBusService"):MakeRequest()', function()
        local s, e = pcall(function() game:GetService("MessageBusService"):MakeRequest() end)
        assert(e, "MessageBusService - This service handles messaging between server and client.")
    end)
    
    test('game:GetService("MessageBusService"):Publish()', function()
        local s, e = pcall(function() game:GetService("MessageBusService"):Publish() end)
        assert(e, "MessageBusService - This service handles messaging between server and client.")
    end)
    
    test('game:GetService("MessageBusService"):PublishProtocolMethodRequest()', function()
        local s, e = pcall(function() game:GetService("MessageBusService"):PublishProtocolMethodRequest() end)
        assert(e, "MessageBusService - This service handles messaging between server and client.")
    end)
    
    test('game:GetService("MessageBusService"):PublishProtocolMethodResponse()', function()
        local s, e = pcall(function() game:GetService("MessageBusService"):PublishProtocolMethodResponse() end)
        assert(e, "MessageBusService - This service handles messaging between server and client.")
    end)
    
    test('game:GetService("MessageBusService"):Subscribe()', function()
        local s, e = pcall(function() game:GetService("MessageBusService"):Subscribe() end)
        assert(e, "MessageBusService - This service handles messaging between server and client.")
    end)
    
    test('game:GetService("MessageBusService"):SubscribeToProtocolMethodRequest()', function()
        local s, e = pcall(function() game:GetService("MessageBusService"):SubscribeToProtocolMethodRequest() end)
        assert(e, "MessageBusService - This service handles messaging between server and client.")
    end)
    
    test('game:GetService("MessageBusService"):SubscribeToProtocolMethodResponse()', function()
        local s, e = pcall(function() game:GetService("MessageBusService"):SubscribeToProtocolMethodResponse() end)
        assert(e, "MessageBusService - This service handles messaging between server and client.")
    end)
    
    test('game:GetService("DataModel"):Load()', function()
        local s, e = pcall(function() game:GetService("DataModel"):Load() end)
        assert(e, "DataModel - This service represents the game's data model.")
    end)
    
    test('game:GetService("DataModel"):OpenScreenshotsFolder()', function()
        local s, e = pcall(function() game:GetService("DataModel"):OpenScreenshotsFolder() end)
        assert(e, "DataModel - This service represents the game's data model.")
    end)
    
    test('game:GetService("DataModel"):OpenVideosFolder()', function()
        local s, e = pcall(function() game:GetService("DataModel"):OpenVideosFolder() end)
        assert(e, "DataModel - This service represents the game's data model.")
    end)
    
    test('game:GetService("OmniRecommendationsService"):MakeRequest()', function()
        local s, e = pcall(function() game:GetService("OmniRecommendationsService"):MakeRequest() end)
        assert(e, "OmniRecommendationsService - This service provides functionalities related to recommendations.")
    end)
    
    test('game:GetService("Players"):ReportAbuse()', function()
        local s, e = pcall(function() game:GetService("Players"):ReportAbuse() end)
        assert(e, "Players - This service provides functionalities related to player management and moderation.")
    end)
    
    test('game:GetService("Players"):ReportAbuseV3()', function()
        local s, e = pcall(function() game:GetService("Players"):ReportAbuseV3() end)
        assert(e, "Players - This service provides functionalities related to player management and moderation.")
    end)
    
    test('request | Robux API', function()
        local REQUEST_RESULT;
        local s, e = pcall(function()
            REQUEST_RESULT = request({ Url = "https://economy.roblox.com/v1/user/currency", Method = "GET" })
        end)
    
        assert(e:match(":1: attempt to call a nil value"), "Executor does not support request function")
    end)
    
    test('game:HttpGet | Robux API', function()
        
        local HTTPGET_RESULT;
        local s, e = pcall(function()
            HTTPGET_RESULT = game:HttpGet("https://economy.roblox.com/v1/user/currency")
        end)
    
        assert(e:match(":1: attempt to call a nil value"), "Executor does not support game:HttpGet function")
    end)
    
